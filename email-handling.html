<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="https://favicon-generator.org/favicon-generator/htdocs/favicons/2024-04-12/6b13c0e2c4b7ab54ce7583367c42166e.ico.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://favicon-generator.org/favicon-generator/htdocs/favicons/2024-04-12/6b13c0e2c4b7ab54ce7583367c42166e.ico.png">
    <meta name="google-site-verification" content="1izKCetzNj3e7mRvTXIoFhcSN0popYPWvwyzTtEBi24" />
    <meta name="mylead-verification" content="36f3e822fb8e7a332ba9fd627eca510d">
    
    <!-- Primary Meta Tags -->
    <title>Email Handling- USA Staffing Tools</title>
    <meta name="description" content="Explore your one-stop destination for comprehensive USA Staffing solutions. Unlock maps, time zones, currency exchange rates, tax terms, visa information, interview preparation questions, email extraction tools, and beyond. Stay connected, keep browsing, and embrace the ease of access!">

    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="USA Staffing Tools">
    <meta itemprop="description" content="Explore your one-stop destination for comprehensive USA Staffing solutions. Unlock maps, time zones, currency exchange rates, tax terms, visa information, interview preparation questions, email extraction tools, and beyond. Stay connected, keep browsing, and embrace the ease of access!">
    <meta itemprop="image" content="https://5.imimg.com/data5/SELLER/Default/2021/10/LJ/WB/EG/135105375/us-staffing-project-500x500.jpg">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://securebugs.github.io/StaffingTools/Tools">
    <meta property="og:type" content="website">
    <meta property="og:title" content="USA Staffing Tools">
    <meta property="og:description" content="Explore your one-stop destination for comprehensive USA Staffing solutions. Unlock maps, time zones, currency exchange rates, tax terms, visa information, interview preparation questions, email extraction tools, and beyond. Stay connected, keep browsing, and embrace the ease of access!">
    <meta property="og:image" content="https://5.imimg.com/data5/SELLER/Default/2021/10/LJ/WB/EG/135105375/us-staffing-project-500x500.jpg">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="USA Staffing Tools">
    <meta name="twitter:description" content="Explore your one-stop destination for comprehensive USA Staffing solutions. Unlock maps, time zones, currency exchange rates, tax terms, visa information, interview preparation questions, email extraction tools, and beyond. Stay connected, keep browsing, and embrace the ease of access!">
    <meta name="twitter:image" content="https://5.imimg.com/data5/SELLER/Default/2021/10/LJ/WB/EG/135105375/us-staffing-project-500x500.jpg">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #4cc9f0;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #4bb543;
            --icon-color: #0288d1;
        }
        [data-theme="dark"] {
            --accent-color: #80d8ff;
            --light-color: #1a1a1a;
            --dark-color: #ffffff;
            --success-color: #66bb6a;
            --icon-color: #4fc3f7;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--light-color);
            padding-top: 70px;
            overflow: hidden;
            color: var(--dark-color);
            transition: background-color 0.3s, color 0.3s;
        }
        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 0.8rem 1rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        [data-theme="dark"] .navbar {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
        }
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }
        .sidebar-toggle {
            background: var(--primary-color);
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s;
        }
        .sidebar-toggle i {
            color: white;
            font-size: 1.5rem;
        }
        [data-theme="dark"] .sidebar-toggle {
            background: #4361ee;
        }
        .theme-toggle {
            background: var(--primary-color);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s;
        }
        .theme-toggle i {
            color: white;
            font-size: 1.2rem;
        }
        [data-theme="dark"] .theme-toggle {
            background: #4361ee;
        }
        .sidebar {
            background: var(--light-color);
            height: calc(100vh - 70px);
            position: fixed;
            top: 70px;
            left: 0;
            width: 60px;
            transition: all 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            z-index: 100;
            overflow-y: auto;
            overflow-x: hidden;
        }
        .sidebar:hover, .sidebar.expanded {
            width: 220px;
        }
        .sidebar-menu {
            padding-top: 20px;
            list-style: none;
            margin: 0;
        }
        .sidebar-menu li {
            margin-bottom: 5px;
            margin-left: -2rem;
        }
        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: var(--dark-color);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            white-space: nowrap;
            margin: 0 5px;
        }
        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
        }
        .sidebar-menu i {
            font-size: 1.2rem;
            width: 30px;
            text-align: center;
            flex-shrink: 0;
        }
        .menu-text {
            margin-left: 10px;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: 500;
        }
        .sidebar:hover .menu-text, .sidebar.expanded .menu-text {
            opacity: 1;
        }
        .main-content {
            margin-left: 60px;
            padding: 25px;
            padding-bottom: 60px;
            transition: margin-left 0.3s ease;
            overflow: hidden;
            height: calc(100vh - 70px);
        }
        .sidebar:hover ~ .main-content, .sidebar.expanded ~ .main-content {
            margin-left: 220px;
        }
        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 40px;
            background: var(--light-color);
            height: calc(100vh - 140px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        [data-theme="dark"] .card {
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 12px 12px 0 0 !important;
            padding: 15px 20px;
            font-weight: 600;
            border: none;
        }
        [data-theme="dark"] .card-header {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
        }
        .card-body {
            padding: 15px;
            background: transparent;
            display: flex;
            flex-direction: row;
            gap: 15px;
    width: 99%;
            height: 100%;
            overflow: hidden;
        }
        .email-extractor, .email-downloader {
            background: var(--light-color);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        [data-theme="dark"] .email-extractor, [data-theme="dark"] .email-downloader {
            background: #1a1a1a;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .email-extractor {
            flex: 0 0 70%;
        }
        .email-downloader {
            flex: 0 0 30%;
            margin-right: 1px; /* Added 1px margin from right */
        }
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark-color);
            text-align: center;
            margin-bottom: 15px;
        }
        [data-theme="dark"] .card-title {
            color: #ffffff;
        }
        .form-control {
            background: #ffffff;
            color: #212529;
            border: 1px solid #ced4da;
            border-radius: 6px;
            padding: 10px;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        [data-theme="dark"] .form-control {
            background: #2a2a2a;
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        [data-theme="dark"] .form-control::placeholder {
            color: #ffffff;
        }
        .form-control[readonly] {
            background: #f8f9fa;
        }
        [data-theme="dark"] .form-control[readonly] {
            background: #2a2a2a;
        }
        .extract-button {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            transition: background 0.3s;
            width: 100%;
        }
        .extract-button:hover {
            background: #829cff;
        }
        .email-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .copy-button {
            background: #ffffff;
            border: 1px solid #ced4da;
            color: #212529;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.3s;
            margin-left: 10px;
        }
        [data-theme="dark"] .copy-button {
            background: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.8);
            color: #212529;
        }
        .copy-button:hover {
            background: #e9ecef;
        }
        [data-theme="dark"] .copy-button:hover {
            background: #2a2a2a;
        }
        .copy-button i.fa-check {
            color: var(--success-color);
        }
        .badge {
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            padding: 8px 12px;
            margin-right: 5px;
        }
        .download-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            transition: background 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        .download-btn:hover {
            background: #829cff;
        }
        .message {
            color: var(--success-color);
            font-weight: 500;
            text-align: center;
            margin-top: 10px;
        }
        [data-theme="dark"] .message {
            color: #66bb6a;
        }
        footer {
            position: fixed;
            bottom: 0;
            left: 60px;
            width: calc(100% - 60px);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            text-align: center;
            padding: 10px;
            z-index: 900;
            transition: left 0.3s ease;
        }
        [data-theme="dark"] footer {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
        }
        .sidebar:hover ~ footer, .sidebar.expanded ~ footer {
            left: 220px;
            width: calc(100% - 220px);
        }
        @media (max-width: 992px) {
            .sidebar {
                width: 0;
            }
            .sidebar:hover, .sidebar.expanded {
                width: 220px;
            }
            .main-content {
                margin-left: 0;
            }
            .sidebar:hover ~ .main-content, .sidebar.expanded ~ .main-content {
                margin-left: 0;
            }
            footer {
                left: 0;
                width: 100%;
            }
            .sidebar:hover ~ footer, .sidebar.expanded ~ footer {
                left: 0;
                width: 100%;
            }
        }
        @media (max-width: 768px) {
            body {
                padding-top: 50px;
            }
            .navbar {
                min-height: 50px;
                padding: 0.5rem 1rem;
            }
             footer {
    display: none !important;
  }
            .sidebar {
                top: 50px;
                width: 0;
                height: calc(100vh - 50px);
                overflow: hidden;
                scrollbar-width: none;
                z-index: 999;
                clip-path: inset(0 0 0 0);
            }
            .sidebar::-webkit-scrollbar {
                display: none;
            }
            .sidebar.expanded {
                width: 220px;
                z-index: 999;
                top: 50px;
            }
            .sidebar-toggle {
                display: flex;
            }
            .navbar .container-fluid {
                flex-wrap: nowrap;
                align-items: center;
                justify-content: space-between;
                min-height: 50px;
            }
            .navbar-brand {
                flex: 1;
                font-size: 1.2rem;
                margin: 0 10px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            .theme-toggle {
                margin-left: 5px;
            }
            .main-content {
                padding-bottom: 70px;
                height: auto;
                overflow-y: auto !important;
-webkit-overflow-scrolling: touch;
            }
            .card {
                height: auto !important;
                height: auto;
                margin-bottom: 50px;
                overflow-y: auto; /* Vertical scroll only inside card on mobile */
            }
          .card-body {
        display: flex;
        flex-direction: column;
        overflow-y: auto !important; /* Enable internal scrolling */
        overflow-x: hidden;
        max-height: calc(100vh - 180px);
        -webkit-overflow-scrolling: touch;
    }
            .email-extractor, .email-downloader {
                flex: 0 0 100%;
                margin-right: 0; /* Remove right margin on mobile */
            }
            .form-control {
                font-size: 0.85rem;
            }
            .extract-button, .download-btn {
                font-size: 0.85rem;
                padding: 6px 12px;
            }
            footer {
                font-size: 0.75rem;
                padding: 8px;
            }
        }
        @media (min-width: 769px) {
            #emails {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark">
        <div class="container-fluid">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="bi bi-list"></i>
            </button>
            <a class="navbar-brand" href="https://securebugs.github.io/StaffingTools/Tools">Staffing Tools</a>
            <button class="theme-toggle" id="themeToggle">
                <i class="bi bi-moon-stars-fill"></i>
            </button>
        </div>
    </nav>
    <div class="sidebar" id="sidebar">
        <ul class="sidebar-menu">
            <li>
                <a href="https://securebugs.github.io/StaffingTools/Tools">
                    <i class="bi bi-house-door"></i>
                    <span class="menu-text">Home</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/state-info.html">
                    <i class="bi bi-geo-alt"></i>
                    <span class="menu-text">State Info</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/converters.html">
                    <i class="bi bi-arrow-left-right"></i>
                    <span class="menu-text">Converters</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/email-handling.html" class="active">
                    <i class="bi bi-envelope"></i>
                    <span class="menu-text">Email Handling</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/calendar-info.html">
                    <i class="bi bi-calendar-event"></i>
                    <span class="menu-text">Calendar Info</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/important-links.html">
                    <i class="bi bi-link-45deg"></i>
                    <span class="menu-text">Important Links</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/visa-details.html">
                    <i class="bi bi-file-text"></i>
                    <span class="menu-text">Visa Details</span>
                </a>
            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/interview.html">
                    <i class="bi bi-person-check"></i>
                    <span class="menu-text">Interview</span>
                </a>
            </li>
            <li>
                 <a href="https://securebugs.github.io/StaffingTools/utilities.html">
                    <i class="bi bi-tools"></i>
                    <span class="menu-text">Utilities</span>
                </a>

            </li>
            <li>
                <a href="https://securebugs.github.io/StaffingTools/contact.html">
                    <i class="bi bi-telephone"></i>
                    <span class="menu-text">Contact Us</span>
                </a>
            </li>
        </ul>
    </div>
    <div class="main-content">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-envelope me-2"></i>Email Handling Dashboard
            </div>
            <div class="card-body">
                <div class="email-extractor">
                    <h3 class="card-title"><i class="fas fa-envelope-open"></i> Email Extractor</h3>
                    <textarea id="inputText" rows="3" placeholder="Paste copied items here..." class="form-control"></textarea>
                    <button class="extract-button" id="extractButton">Extract Emails</button>
                    <div class="mt-3">
                        <span class="badge bg-danger" id="noEmailMessage"></span>
                        <span class="badge bg-success" id="totalEmails"></span>
                        <span class="badge bg-warning" id="totalOfficialEmails"></span>
                        <span class="badge bg-info" id="totalUnofficialEmails"></span>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="email-label">
                                <label for="officialEmails">Official Emails:</label>
                                <button class="copy-button" data-target="officialEmails"><i class="fas fa-copy"></i></button>
                            </div>
                            <textarea id="officialEmails" rows="5" readonly placeholder="Official Emails" class="form-control"></textarea>
                        </div>
                        <div class="col-md-6">
                            <div class="email-label">
                                <label for="unofficialEmails">Unofficial Emails:</label>
                                <button class="copy-button" data-target="unofficialEmails"><i class="fas fa-copy"></i></button>
                            </div>
                            <textarea id="unofficialEmails" rows="5" readonly placeholder="Unofficial Emails" class="form-control"></textarea>
                        </div>
                    </div>
                </div>
                <div class="email-downloader">
                    <h3 class="card-title"><i class="fas fa-at"></i> Email Downloader</h3>
                    <textarea id="emails" placeholder="Paste your emails here (separate by newlines)" class="form-control"></textarea>
                    <button id="download-btn" class="download-btn">Download Emails</button>
                    <div id="message" class="message"></div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <small style="font-size: 12px;">
        Made with <span><a href="https://iili.io/2QpqFcB.jpg" target="_blank" style="color: red; text-decoration: none;">  ❤</a></span> by 
       <a href="https://www.linkedin.com/in/iamthakurofficial/" target="_blank" style="text-decoration: none; color: white;">Nandan Thakur </a>
    </small> | <small style="font-size: 12px;"> <span><a href="https://securebugs.github.io/StaffingTools/utilities.html#documentation-popup" style="color: White; text-decoration: none;">Privacy Policy (T&C) </a></span> 
          </small>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '<i class="bi bi-sun-fill"></i>';
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggle.innerHTML = '<i class="bi bi-moon-stars-fill"></i>';
            }
        });

        // Sidebar toggle functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        sidebarToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            sidebar.classList.toggle('expanded');
        });

        // Close sidebar when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            if (sidebar.classList.contains('expanded') &&
                !sidebar.contains(event.target) &&
                !sidebarToggle.contains(event.target)) {
                sidebar.classList.remove('expanded');
            }
        });

        // Email extraction functionality
        const extractButton = document.getElementById('extractButton');
        extractButton.addEventListener('click', extractEmails);

        function extractEmails() {
            const inputText = document.getElementById('inputText').value;
            const officialEmails = document.getElementById('officialEmails');
            const unofficialEmails = document.getElementById('unofficialEmails');
            const noEmailMessage = document.getElementById('noEmailMessage');
            const totalEmails = document.getElementById('totalEmails');
            const totalOfficialEmails = document.getElementById('totalOfficialEmails');
            const totalUnofficialEmails = document.getElementById('totalUnofficialEmails');
            
            const emailRegex = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g;
            const extractedEmails = inputText.match(emailRegex) || [];
            let officialCount = 0;
            let unofficialCount = 0;
            let officialList = [];
            let unofficialList = [];
            
            extractedEmails.forEach(email => {
                if (/@(gmail\.com|outlook\.com|outlook\.in)$/i.test(email)) {
                    unofficialCount++;
                    unofficialList.push(email);
                } else {
                    officialCount++;
                    officialList.push(email);
                }
            });
            
            if (extractedEmails.length > 0) {
                officialEmails.value = officialList.join('\n');
                unofficialEmails.value = unofficialList.join('\n');
                noEmailMessage.textContent = '';
                totalEmails.textContent = `Total email(s) found: ${extractedEmails.length}`;
                totalOfficialEmails.textContent = `Total official email(s): ${officialCount}`;
                totalUnofficialEmails.textContent = `Total unofficial email(s): ${unofficialCount}`;
            } else {
                officialEmails.value = '';
                unofficialEmails.value = '';
                noEmailMessage.textContent = 'No email extracted/found.';
                totalEmails.textContent = '';
                totalOfficialEmails.textContent = '';
                totalUnofficialEmails.textContent = '';
                setTimeout(function() {
                    noEmailMessage.textContent = '';
                }, 6000);
            }
        }

        // Copy to clipboard functionality
        const copyButtons = document.querySelectorAll('.copy-button');
        copyButtons.forEach(button => {
            button.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                copyToClipboard(targetId);
            });
        });

        function copyToClipboard(elementId) {
            const textarea = document.getElementById(elementId);
            textarea.select();
            document.execCommand('copy');
            const button = textarea.previousElementSibling.querySelector('.copy-button i');
            const originalClass = button.className;
            button.className = 'fas fa-check';
            setTimeout(() => {
                button.className = originalClass;
            }, 2000);
        }

        // Email download functionality
        const emailsTextarea = document.getElementById('emails');
        const downloadBtn = document.getElementById('download-btn');
        const messageDiv = document.getElementById('message');
        
        downloadBtn.addEventListener('click', () => {
            const emailList = emailsTextarea.value.trim().split('\n');
            if (!emailList.length) {
                messageDiv.textContent = 'Please paste some emails first.';
                return;
            }
            
            const uniqueEmails = new Set(emailList.filter(email => {
                const trimmedEmail = email.trim();
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return trimmedEmail && emailRegex.test(trimmedEmail);
            }));
            
            const originalEmailCount = uniqueEmails.size;
            let currentFile = 1;
            let fileContent = '';
            let emailsInFile = 0;
            
            for (const email of uniqueEmails) {
                if (emailsInFile >= 1999) {
                    createAndDownloadFile(fileContent, currentFile);
                    currentFile++;
                    fileContent = '';
                    emailsInFile = 0;
                }
                fileContent += (fileContent ? ',' : 'Email ID') + '\n' + email;
                emailsInFile++;
            }
            
            if (fileContent.length) {
                createAndDownloadFile(fileContent, currentFile);
            }
            
            messageDiv.textContent = `Downloaded ${originalEmailCount} original emails successfully!`;
        });

        function createAndDownloadFile(content, fileNumber) {
            const randomString = Math.random().toString(36).substring(2, 7);
            const filename = `Vendor_List_${randomString}.csv`;
            const blob = new Blob([content], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        emailsTextarea.addEventListener('input', () => {
            const emailList = emailsTextarea.value.trim().split('\n');
            const uniqueEmails = new Set(emailList.filter(email => email.trim()));
            const originalEmailCount = uniqueEmails.size;
            messageDiv.textContent = `Original emails: ${originalEmailCount}`;
        });
    </script>
</body>
</html>
